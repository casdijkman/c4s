{#
    SPDX-FileCopyrightText: 2021 Cas Dijkman

    SPDX-License-Identifier: GFDL-1.3-only
#}

{% macro exampleBoxDark(firstClass, caption, debugClass = "debug-striped-black", borderColorClass = "b--black") %}
    <div class="dib p3 ba {{ borderColorClass }} {{ debugClass }}">
        {{ caller(firstClass, caption) }}
    </div>
{% endmacro %}

{% macro exampleBox(firstClass, caption, debugClass = "debug-striped-light", borderColorClass = "b--black-10") %}
    <div class="dib p3 ba {{ borderColorClass }} {{ debugClass }}">
        {{ caller(firstClass, caption) }}
    </div>
{% endmacro %}

{% macro exampleNotFound(type, reason) %}
    <div class="o-50" data-example-not-found="{{ type }}">
        (Example not found
        {%- if reason -%}
            , {{ reason }}
        {%- endif -%})
    </div>
{% endmacro %}

{% macro example(type, selectors, declarations) %}
    {% set firstSelector %}{{ selectors | first }}{% endset %}
    {% set firstClass %}{{ firstSelector | getClassFromSelector }}{% endset %}
    {% set readableClasses %}{{ selectors | getClassesFromSelectors | join(" or ") }}{% endset %}
    {% set caption = "Element with class <code>" + readableClasses + "</code>" %}

    {% if type === "" %}
        <div data-example-not-found="no type"></div>
    {% elif type === "aspect-ratio" %}
        <div class="df items-center justify-center ba h5 p3 tc {{ firstClass }}">
            <span>{{ caption | safe }}</span>
        </div>
    {% elif type === "background-clip" %}
        <div class="ba f1 b black-20 debug-striped-black {{ firstClass }}"
            style="background-image: repeating-linear-gradient(-45deg, transparent 0 10px, black 10px 20px);">
            {{ caption | safe }}
        </div>
    {% elif type === "background-color" %}
        {% if r/^bg-white-/.test(firstClass) %}
              {% call exampleBoxDark(firstClass, caption) %}
                  <div class="p3 {{ firstClass }}">
                      <div class="pt3-between">{{ caption | safe }}</div>
                      <div class="white text-shadow pt3-between">{{ caption | safe }}</div>
                  </div>
              {% endcall %}
        {% else %}
              {% call exampleBox(firstClass, caption) %}
                  <div class="p3 {{ firstClass }}">
                      <div class="pt3-between">{{ caption | safe }}</div>
                      <div class="white text-shadow pt3-between">{{ caption | safe }}</div>
                  </div>
              {% endcall %}
        {% endif %}
    {% elif type === "background-repeat" %}
          {% call exampleBox(firstClass, caption) %}
              <div class="p3 {{ firstClass }}" style="background-image: url('/logo.svg'); background-size: 7rem;">
                  <div class="p2 bg-white-90">
                      {{ caption | safe }}
                  </div>
              </div>
          {% endcall %}
    {% elif type === "background-size" %}
          <div class="measure">
              <div class="ratio-16x9 overflow-auto resize p3">
                  <div class="w-100 h-100 {{ firstClass }}" style="background-image: url('/docs/assets/500x400.jpg')"></div>
              </div>
          </div>
    {% elif type === "border-color" %}
        <div class="dt p3">
            <div class="ba p2 {{ firstClass }}">
                {{ caption | safe }}
            </div>
        </div>
        <div class="dt bg-black white p3">
            <div class="ba p2 {{ firstClass }}">
                {{ caption | safe }}
            </div>
        </div>
    {% elif type === "border-radius" %}
        <div class="dib p3 ba {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "border-style" %}
        <div class="dib ba bw2 p1 {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "border-width" %}
        <div class="dib p1 ba {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "border" %}
        <div class="dib bg-black-10 p1 {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "box-shadow" %}
        <div class="row column-gap row-gap">
            <div class="col-auto p3 {{ firstClass }}">
                {{ caption | safe }}
            </div>

            <div class="col-auto p3 br-pill {{ firstClass }}">
                {{ caption | safe }}
            </div>
        </div>
    {% elif type === "box-sizing" %}
        <div class="tc debug-striped w5 p3 mb2">
            Element with class w5
        </div>
        <div class="ba bw5 p2 w5 {{ firstClass }}">
            {{ caption | safe }} and w5
        </div>
    {% elif type === "color" %}
        <div class="dib ba p3">
            <div class="dib p1 {{ firstClass }}">
                {{ caption | safe }}
            </div>
            <br>
            <div class="dib bg-black p1 {{ firstClass }}">
                {{ caption | safe }}
            </div>
        </div>
    {% elif type === "complex" %}
        {% if firstClass === "bt-between" %}
            <div class="dib ba p3">
                <div class="dif flex-column">
                    {% for i in [1, 2, 3] %}
                        <div class="bg-black-10 p1 {{ firstClass }}">
                            {{ caption | safe }}
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% elif firstClass === "bl-between" %}
            <div class="dib ba p3">
                <div class="df">
                    {% for i in [1, 2, 3] %}
                        <div class="dib bg-black-10 p1 {{ firstClass }}">
                            {{ caption | safe }}
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% elif r/pt.-between$/.test(firstClass) %}
            <div class="dib ba bg-black-10 {{ firstClass }}">
                {{ caption | safe }}
            </div>
            <div class="dib ba bg-black-10 {{ firstClass }}">
                {{ caption | safe }}
            </div>
        {% elif r/pl.-between$/.test(firstClass) %}
            <div class="dib ba bg-black-10 {{ firstClass }}">
                {{ caption | safe }}
            </div>
            <div class="dib ba bg-black-10 {{ firstClass }}">
                {{ caption | safe }}
            </div>
        {% elif r/mt.-between$/.test(firstClass) %}
            <div class="dt ba bg-black-10 {{ firstClass }}">
                {{ caption | safe }}
            </div>
            <div class="dt ba bg-black-10 {{ firstClass }}">
                {{ caption | safe }}
            </div>
        {% elif r/ml.-between$/.test(firstClass) %}
            <div class="dib ba bg-black-10 {{ firstClass }}">
                {{ caption | safe }}
            </div>
            <div class="dib ba bg-black-10 {{ firstClass }}">
                {{ caption | safe }}
            </div>
        {% else %}
            {{ exampleNotFound(type) }}
        {% endif %}
   {% elif type === "coordinates" %}
        <div class="relative ba w-50 h4">
            <div class="dib white bg-black absolute {{ firstClass }}">
                {{ caption | safe }}
            </div>
        </div>
    {% elif type === "cursor" %}
        <div class="dib ba p3 {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "debug" %}
        <div class="p4 {{ firstClass }}">
            <span class="p2 bg-white-90">
                {{ caption | safe }}
            </span>
        </div>
    {% elif type === "display" %}
        <div class="bg-black-10 p3 {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "flex-direction" %}
        <div class="dif {{ firstClass }}">
            {% for i in [1, 2, 3] %}
                <div class="p2">
                    <div class="bg-black white">
                        Child {{ i }}
                    </div>
                </div>
            {% endfor %}
        </div>
   {% elif type === "flex" %}
        {% if r/.*wrap.*/.test(firstClass) %}
            <div class="df measure ba p1 {{ firstClass }}">
                <div class="p2 m1 debug-striped ba">
                    Child of element with class {{ firstClass }}
                </div>
                {% for i in [2, 3, 4, 5] %}
                    <div class="p2 m1 debug-striped ba">
                        Child {{ i }}
                    </div>
                {% endfor %}
            </div>
        {% elif r/^items-.*/.test(firstClass) %}
            <div class="debug-striped p2 df h5 measure {{ firstClass }}">
                <div class="col-6 p2">
                    <div class="ba p2 h-100">
                        Child of element with class {{ firstClass }}
                    </div>
                </div>
                <div class="col-6 p2">
                    <div class="f2 ba p2 h-100">
                        Child 2
                    </div>
                </div>
            </div>
        {% elif r/^self-/.test(firstClass) %}
            {{ exampleNotFound(type + " align-self") }}
        {% elif r/^content-/.test(firstClass) %}
            {{ exampleNotFound(type + " align-content") }}
        {% elif r/^justify-/.test(firstClass) %}
            {{ exampleNotFound(type + " justify-content") }}
        {% elif r/^flex-(grow|shrink)/.test(firstClass) %}
            {{ exampleNotFound(type + " grow/shrink") }}
        {% elif r/^order/.test(firstClass) %}
            {{ exampleNotFound(type + " order") }}
        {% else %}
            {{ exampleNotFound(type) }}
        {% endif %}
    {% elif type === "float" %}
        <div class="ba w5 h4">
            <div class="dib white bg-black {{ firstClass }}">
                {{ caption | safe }}
            </div>
        </div>
    {% elif type === "font-family" %}
        <div class="{{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "font-size" %}
        <span class="{{ firstClass }}">
            {{ caption | safe }}
        </span>
    {% elif type === "font-style" %}
        <div class="dib p3 ba">
            <div class="{{ firstClass }}">
                {{ caption | safe }}
            </div>
        </div>
    {% elif type === "font-weight" %}
        <div class="{{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "grid" %}
        {% if r/-gap$/.test(firstClass) %}
            <div class="row {{ firstClass }}">
                <div class="col-12">
                    {{ caption | safe }}
                </div>
                <div class="col-6 debug-striped ba b--black-10 p2">
                    col-6
                </div>
                <div class="col-3 debug-striped ba b--black-10 p2">
                    col-3
                </div>
                <div class="col-3 debug-striped ba b--black-10 p2">
                    col-3
                </div>
                <div class="col-3 debug-striped ba b--black-10 p2">
                    col-3
                </div>
                <div class="col-6 debug-striped ba b--black-10 p2">
                    col-6
                </div>
                <div class="col-3 debug-striped ba b--black-10 p2">
                    col-3
                </div>
            </div>
        {% elif r/^row/.test(firstClass) %}
            {{ exampleNotFound(type + " row") }}
        {% elif r/^col/.test(firstClass) %}
            {{ exampleNotFound(type + " col") }}
        {% else %}
            {{ exampleNotFound(type) }}
        {% endif %}
    {% elif type === "height" %}
        <div class="dib white bg-black {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "hover-background-color" %}
        <div class="dib p3 ba">
            <div class="dib {{ firstClass }}">
                {{ caption | safe }}
            </div>
            <br>
            <div class="dib white {{ firstClass }}">
                {{ caption | safe }}
            </div>
        </div>
   {% elif type === "hover-color" %}
        <div class="dib p3 ba">
            <div class="dib {{ firstClass }}">
                {{ caption | safe }}
            </div>
            <br>
            <div class="dib bg-black white {{ firstClass }}">
                {{ caption | safe }}
            </div>
        </div>
    {% elif type === "hover" %}
        {{ exampleNotFound(type) }}
    {% elif type === "letter-spacing" %}
        <span class="{{ firstClass }}">
            {{ caption | safe }}
        </span>
    {% elif type === "line-height" %}
        <div class="dib bg-black white">
            <span class="{{ firstClass }}">
                {{ caption | safe }}
            </span>
        </div>
    {% elif type === "margin" %}
        {% if r/[rlh]-auto$/.test(firstClass) %}
            <div class="ba">
                <div class="w4 white bg-black {{ firstClass }}">
                    {{ caption | safe }}
                </div>
            </div>
        {% else %}
            <div class="dib ba">
                <div class="dib white bg-black {{ firstClass }}">
                    {{ caption | safe }}
                </div>
            </div>
        {% endif %}
    {% elif type === "max-width" %}
        <div class="overflow-x-auto">
            <div class="dib ba b--black-20 debug-striped-light pv3 {{ firstClass }}">
                {{ caption | safe }}
                <div class="ba b--black-20 debug-striped p2 mt2"
                    style="width: 2000px;">
                    Very wide child element
                </div>
            </div>
        </div>
    {% elif type === "measure" %}
        <div class="bg-black white {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "miscellaneous" %}
        {% if firstClass === "list-reset" %}
            <ul class="dib ba p3 {{ firstClass }}">
                {% for i in [1, 2, 3] %}
                    <li>List item in <code>&lt;ul&gt;</code> with class {{ firstClass }}</li>
                {% endfor %}
            </ul>
        {% elif r/stretch.*/.test(firstClass) %}
            <div class="measure h4 ba relative">
                <a class="dib p3 debug-striped {{ firstClass }}" href="javascript:;">
                    {{ caption | safe }}
                </a>
            </div>
        {% elif firstClass === "link" %}
            <div class="dib p3 ba">
                <a class="{{ firstClass }}" href="javascript:;">
                    {{ caption | safe }}
                </a>
            </div>
        {% elif firstClass === "dn-empty" %}
            <div class="dib debug-striped ba p3 {{ firstClass }}">
                {{ caption | safe }}
            </div>
            <div class="dib debug-striped ba p3 {{ firstClass }}">
            </div>
        {% else %}
            {{ exampleNotFound(type) }}
        {% endif %}
    {% elif type === "object-fit" %}
        {{ exampleNotFound(type) }}
    {% elif type === "opacity" %}
        <div class="dib bg-black white p3 {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "overflow" %}
        {{ exampleNotFound(type) }}
    {% elif type === "padding" %}
        <div class="dib white bg-black {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "position" %}
        {{ exampleNotFound(type) }}
    {% elif type === "reset" %}
        {% if r/h\d/.test(firstClass) and selectors.length == 6 %}
            header margins
            {{ exampleNotFound(type) }}
        {% elif r/h\d/.test(firstClass) %}
            header
            {{ exampleNotFound(type) }}
        {% elif firstClass == "small" %}
            small
            {{ exampleNotFound(type) }}
        {% elif firstClass == "p" %}
            paragraph
            {{ exampleNotFound(type) }}
        {% elif firstClass == "code" %}
            code
            {{ exampleNotFound(type) }}
        {% else %}
            {# Does not have example #}
        {% endif %}
    {% elif type === "spanning-breakpoints" %}
        {{ exampleNotFound(type) }}
    {% elif type === "table" %}
        {% if firstClass === "collapse" %}
            <table class="ba {{ firstClass }}">
                <tr>
                    <td class="ba p1">
                        {{ caption | safe }}
                    </td>
                </tr>
                <tr>
                    <td class="ba p1">
                        {{ caption | safe }}
                    </td>
                </tr>
            </table>
        {% else %}
            <table class="ba collapse">
                <tr class="{{ firstClass }}">
                    <td class="ba p1">
                        {{ caption | safe }}
                    </td>
                </tr>
                <tr class="{{ firstClass }}">
                    <td class="ba p1">
                        {{ caption | safe }}
                    </td>
                </tr>
                <tr class="{{ firstClass }}">
                    <td class="ba p1">
                        {{ caption | safe }}
                    </td>
                </tr>
            </table>
        {% endif %}
    {% elif type === "text-align" %}
        <div class="ph3 ba measure {{ firstClass }}">
            <p>
                {{ caption | safe }}
            </p>
            <p class="o-50">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
                tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
                veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
                commodo consequat.
            </p>
        </div>
    {% elif type === "text-decoration" %}
        <div class="dib p3 ba {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "text-shadow" %}
        <div class="dib p3 ba {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "text-transform" %}
        <div class="dib p3 ba {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "transform" %}
        {% macro transformBox(firstClass, caption, containerClass, boxClass, textClass) %}
            <div class="top-0 left-50 translateX-n50 w-third word-break-word {{ containerClass }}">
                <div class="p2 ba {{ firstClass }} {{ boxClass }}">
                    <span class="{{ textClass }}">
                        {{ caption | safe }}
                    </span>
                </div>
            </div>
        {% endmacro %}

        {% set paddingClass %}
        {% if r/Y-100$/.test(firstClass) %}
            pb6 pb5-m pt3 pt4-s
        {% elif r/Y-n100$/.test(firstClass) %}
            pt6 pt5-m pb3 pb4-s
        {% elif r/Y-50$/.test(firstClass) %}
            pb5 pb4-m pt3 pt4-s
        {% elif r/Y-n50$/.test(firstClass) %}
            pt5 pt4-m pb3 pb4-s
        {% else %}
            pv3
        {% endif %}
        {% endset %}

        <div class="{{ paddingClass }}">
            <div class="relative">
                {# Placeholder #}
                {{ transformBox(firstClass, caption, "hidden") }}

                {# Ghost #}
                {{ transformBox("", caption, "absolute o-40", "debug-striped b--dashed", "hidden") }}

                {# Visible element #}
                {{ transformBox(firstClass, caption, "absolute") }}
            </div>
        </div>
    {% elif type === "transition" %}
        {{ exampleNotFound(type) }}
    {% elif type === "user-select" %}
        {{ exampleNotFound(type) }}
    {% elif type === "vertical-align" %}
        <div class="dib bg-black white lh-extra ph2">
            <div class="dib ba b--red bw2 mr2 {{ firstClass }}"></div>
            {{ caption | safe }}
        </div>
    {% elif type === "visibility" %}
        <div class="dib bg-black white p1 {{ firstClass }}">
            {{ caption | safe }}
        </div>
    {% elif type === "white-space" %}
        <div class="w4 bg-black-10 p2 ba {{ firstClass }}">
            {{ caption | safe }}
            <!--! -->
            {{ caption | safe }}
            <!--! -->
        </div>
    {% elif type === "width" %}
        <div class="ba">
            <div class="dib white bg-black {{ firstClass }}">
                {{ caption | safe }}
            </div>
        </div>
    {% elif type === "word-break" %}
        <div class="ba ph3 w4 {{ firstClass }}">
            <p>
                {{ caption | safe }}
            </p>
            <p class="o-60">
                ElementWithClass{{ firstClass | title }}ToIllustrateWordBreakingWithLongWords
            </p>
        </div>
    {% elif type === "z-index" %}
        {{ exampleNotFound(type) }}
    {% else %}
        {{ exampleNotFound(type, "not yet specified") }}
    {% endif %}
{% endmacro %}
